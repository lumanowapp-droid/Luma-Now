"use strict";var l=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var j=(e,t)=>{for(var r in t)l(e,r,{get:t[r],enumerable:!0})},G=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of N(t))!R.call(e,a)&&a!==r&&l(e,a,{get:()=>t[a],enumerable:!(o=V(t,a))||o.enumerable});return e};var J=e=>G(l({},"__esModule",{value:!0}),e);var W={};j(W,{selectBrainDumpText:()=>O,selectCapacity:()=>D,selectCurrentView:()=>A,selectFocusState:()=>z,selectIsProcessing:()=>b,selectModalOpen:()=>M,selectSettings:()=>F,selectTasks:()=>w,storage:()=>m,useAppStore:()=>d,useLumaStore:()=>d});module.exports=J(W);var P=require("zustand"),h=require("zustand/middleware/immer");var p=()=>typeof window<"u"&&typeof localStorage<"u",m={getItem:async e=>{try{return p()?localStorage.getItem(e):null}catch(t){return console.error("localStorage.getItem failed:",t),null}},setItem:async(e,t)=>{try{if(!p())return;localStorage.setItem(e,t)}catch(r){console.error("localStorage.setItem failed:",r)}},removeItem:async e=>{try{if(!p())return;localStorage.removeItem(e)}catch(t){console.error("localStorage.removeItem failed:",t)}}};var T=(e,t)=>(r,o,a)=>{let{name:s,version:n,partialize:f,onRehydrateStorage:g}=t,$=async()=>{try{let i=await m.getItem(s);if(i){let c=JSON.parse(i);c.version===n?(r(c.state),g&&g(o())):(console.warn(`State version mismatch for "${s}": expected ${n}, got ${c.version}`),await m.removeItem(s))}}catch(i){console.error(`Failed to load persisted state for "${s}":`,i)}},B=async i=>{try{let U={state:f?f(i):i,version:n},E=JSON.stringify(U);await m.setItem(s,E)}catch(c){console.error(`Failed to persist state for "${s}":`,c)}};return a.subscribe(i=>{B(i)}),$(),e(r,o,a)};var u={text:"",isProcessing:!1},k=e=>({...u,setText:t=>{e(r=>{r.text=t})},setIsProcessing:t=>{e(r=>{r.isProcessing=t})},compress:async()=>{e(t=>{t.isProcessing=!0})},reset:()=>{e(t=>{t.text=u.text,t.isProcessing=u.isProcessing})}});var _={tasks:[]},y=e=>({..._,addTask:t=>{e(r=>{let o={...t,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date,order:r.tasks.length};r.tasks.push(o)})},addTasks:t=>{e(r=>{let o=r.tasks.length,a=t.map((s,n)=>({...s,id:`${Date.now()}-${n}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date,order:o+n}));r.tasks.push(...a)})},toggleTask:t=>{e(r=>{let o=r.tasks.find(a=>a.id===t);o&&(o.completed=!o.completed,o.completedAt=o.completed?new Date:void 0)})},removeTask:t=>{e(r=>{let o=r.tasks.findIndex(a=>a.id===t);o!==-1&&(r.tasks.splice(o,1),r.tasks.forEach((a,s)=>{a.order=s}))})},updateTask:(t,r)=>{e(o=>{let a=o.tasks.find(s=>s.id===t);a&&Object.assign(a,r)})},clearCompleted:()=>{e(t=>{t.tasks=t.tasks.filter(r=>!r.completed),t.tasks.forEach((r,o)=>{r.order=o})})},reorderTasks:t=>{e(r=>{let o=new Map(r.tasks.map(a=>[a.id,a]));r.tasks=t.map(a=>o.get(a)).filter(Boolean),r.tasks.forEach((a,s)=>{a.order=s})})}});var S={light:3,medium:5,full:7},Y={currentCapacity:"medium",maxTasks:S.medium},C=e=>({...Y,setCapacity:t=>{e(r=>{r.currentCapacity=t,r.maxTasks=S[t]})},getMaxTasksForCapacity:t=>S[t]});var q={currentTaskId:null,elapsedTime:0,isActive:!1},x=e=>({...q,startFocus:t=>{e(r=>{r.currentTaskId=t,r.elapsedTime=0,r.isActive=!0})},endFocus:()=>{e(t=>{t.currentTaskId=null,t.elapsedTime=0,t.isActive=!1})},updateElapsedTime:t=>{e(r=>{r.elapsedTime=t})}});var H={currentView:"brain-dump",modalOpen:null},v=e=>({...H,setCurrentView:t=>{e(r=>{r.currentView=t})},openModal:t=>{e(r=>{r.modalOpen=t})},closeModal:()=>{e(t=>{t.modalOpen=null})}});var K=()=>"cloudflare",I={defaultCapacity:"medium",theme:"system",reducedMotion:!1,highContrast:!1,fontSize:"medium",hapticFeedback:!0,voiceInput:!1,gentleNudges:!0,dailyReflection:!1,hasCompletedOnboarding:!1,aiProvider:K()},Q={settings:I},L=e=>({...Q,updateSettings:t=>{e(r=>{r.settings={...r.settings,...t}})},resetSettings:()=>{e(t=>{t.settings=I})}});var d=(0,P.create)()((0,h.immer)(T((...e)=>({...k(...e),...y(...e),...C(...e),...x(...e),...v(...e),...L(...e)}),{name:"luma-store",version:1,partialize:e=>({tasks:e.tasks,currentCapacity:e.currentCapacity,maxTasks:e.maxTasks,settings:e.settings}),onRehydrateStorage:e=>{console.log("Luma store rehydrated from storage")}}))),w=e=>e.tasks,A=e=>e.currentView,D=e=>({level:e.currentCapacity,max:e.maxTasks}),F=e=>e.settings,O=e=>e.text,b=e=>e.isProcessing,z=e=>({taskId:e.currentTaskId,elapsed:e.elapsedTime,active:e.isActive}),M=e=>e.modalOpen;
//# sourceMappingURL=index.js.map