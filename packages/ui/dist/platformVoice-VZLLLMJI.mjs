import"./chunk-F3SXD3QV.mjs";var s=class{mediaRecorder=null;audioChunks=[];stream=null;async requestPermissions(){try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(i=>i.stop()),!0}catch{return!1}}async startRecording(){this.audioChunks=[],this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.mediaRecorder=new MediaRecorder(this.stream,{mimeType:"audio/webm"}),this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&this.audioChunks.push(e.data)},this.mediaRecorder.start()}async stopRecording(){return new Promise((e,i)=>{if(!this.mediaRecorder){i(new Error("No active recording"));return}this.mediaRecorder.onstop=()=>{let t=new Blob(this.audioChunks,{type:"audio/webm"}),r=URL.createObjectURL(t);this.stream?.getTracks().forEach(a=>a.stop()),e({uri:r,duration:0,mimeType:"audio/webm"})},this.mediaRecorder.stop()})}async transcribe(e){let t=await(await fetch(e.uri)).blob(),r=new FormData;r.append("audio",t,"recording.webm");let a=await fetch("/api/transcribe",{method:"POST",body:r});if(!a.ok)throw new Error("Transcription failed");let o=await a.json();return{text:o.text,confidence:o.confidence,language:o.language}}isAvailable(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}isEnabled(){return!0}};export{s as VoiceServiceImpl};
//# sourceMappingURL=platformVoice-VZLLLMJI.mjs.map